import{g as r}from"../index.js";document.addEventListener("DOMContentLoaded",function(){const s=document.querySelectorAll(".question-item"),V=document.querySelectorAll(".option"),d=document.getElementById("next-btn"),f=document.getElementById("prev-btn"),F=document.getElementById("question-number"),W=document.querySelector(".progress-bar-inner"),v=document.getElementById("total-score");let i=0,h=0;const S=[];s.forEach((e,t)=>{t!==0&&r.set(e,{display:"none",opacity:0}),e.style.willChange="transform, opacity"});function q(){d.disabled=!0,f.disabled=i===0}function I(){const e=(i+1)/s.length*100;W.style.width=`${e}%`}V.forEach(e=>{e.addEventListener("click",function(){s[i].querySelectorAll(".option").forEach(n=>n.classList.remove("selected")),this.classList.add("selected");const o=parseInt(this.dataset.score,10)||0;S[i]={question:s[i].querySelector(".question").textContent.trim(),response:this.textContent.trim(),score:o},d.disabled=!1})});function z(e,t){r.to(e,{opacity:0,x:-40,duration:.25,ease:"power2.in",onComplete:()=>{e.style.display="none",t&&t()}})}function G(e,t){r.set(e,{display:"block",opacity:0,x:40}),r.to(e,{opacity:1,x:0,duration:.25,ease:"power2.out",onComplete:()=>{t&&t()}})}d.addEventListener("click",function(){const e=S[i];e&&(h+=e.score),v&&(v.value=h),d.disabled=!0,f.disabled=!0;const t=s[i];z(t,function(){if(i++,i<s.length){const o=s[i];F.innerText=i+1,I(),G(o,function(){q()})}else x(null,"ajout-photo")})}),f.addEventListener("click",function(){if(i>0){const e=S[i];e&&(h-=e.score),v&&(v.value=h),d.disabled=!0,f.disabled=!0;const t=s[i];z(t,function(){if(i--,i>=0){const o=s[i];F.innerText=i+1,I(),G(o,function(){q()})}})}}),I(),q(),r.from(".quiz-container",{opacity:0,scale:.95,duration:.5,ease:"power2.out"});const u=document.getElementById("inscription"),g=document.getElementById("connexion"),E=document.getElementById("parrainage"),C=document.getElementById("ajout-photo"),L=document.querySelector(".section-gauche");document.querySelector(".section-droite");const Z=window.matchMedia("(max-width: 530px)").matches;function x(e,t=null){e&&e.preventDefault(),t=t||(e?e.target.getAttribute("href").substring(1):null);let o,n;t==="connexion"?(o=u,n=g,document.body.classList.remove("parrainage-active"),L.style.display=""):t==="inscription"?(o=g,n=u,document.body.classList.remove("parrainage-active"),L.style.display=""):t==="parrainage"?(o=u,n=E,document.body.classList.add("parrainage-active"),L.style.display="none"):t==="ajout-photo"&&(o=E,n=C,document.body.classList.add("parrainage-active"),L.style.display="none"),[u,g,E,C].forEach(ce=>{r.set(ce,{zIndex:-1,display:"none",opacity:0})});let a=150,c=0,y=-150,se=0;(t==="parrainage"||t==="ajout-photo")&&Z&&(a=0,c=200),r.to(o,{opacity:0,x:y,y:se,scale:.95,duration:.3,ease:"power2.in",onComplete:()=>{o.style.display="none"}}),n.style.display="block",r.fromTo(n,{opacity:0,x:a,y:c,scale:.9},{opacity:1,x:0,y:0,scale:1,duration:.4,ease:"power2.out",onStart:()=>{n.style.zIndex=1},onComplete:()=>{n.style.zIndex=2}})}document.querySelectorAll('a[href="#connexion"], a[href="#inscription"]').forEach(e=>{e.addEventListener("click",x)});const T=document.querySelector("#inscription form"),k=document.querySelector("#ajout-photo form");T&&T.addEventListener("submit",function(e){e.preventDefault();const t=new FormData(T);t.forEach((n,a)=>{localStorage.setItem(a,n)});const o=t.get("niveau");o==="L1"||o==="L3"?x(null,"parrainage"):x(null,"ajout-photo")}),k&&(k.querySelectorAll("input, select").forEach(t=>{const o=localStorage.getItem(t.name);o&&(t.value=o)}),k.addEventListener("submit",function(){["nom","prenoms","niveau","email","motDePasse","confirmMotDePasse"].forEach(o=>{const n=localStorage.getItem(o);if(n){const a=document.querySelector(`#hidden-${o}`);a&&(a.value=n)}})})),r.set(g,{zIndex:-1,opacity:0,display:"none"}),r.set(E,{zIndex:-1,opacity:0,display:"none"}),r.set(C,{zIndex:-1,opacity:0,display:"none"}),r.set(u,{zIndex:1,opacity:1,display:"block"}),r.timeline().from(".principal-container",{opacity:0,scale:.9,y:50,duration:.5,ease:"power3.out"}).from(".section-gauche",{opacity:0,x:-40,duration:.5,ease:"power3.out"},"-=0.3").from(".section-droite",{opacity:0,x:40,duration:.5,ease:"power3.out"},"-=0.3").from("#inscription .header-form h3",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2").from("#inscription .body-form .input-group, #inscription .body-form .select-group",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2").from("#inscription .footer-form button",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2"),document.querySelectorAll(".input-group input, .select-group select").forEach(e=>{e.addEventListener("focus",()=>{r.timeline({defaults:{ease:"power2.inOut"}}).to(e,{x:-10,duration:.1}).to(e,{x:10,duration:.2}).to(e,{x:-5,duration:.15}).to(e,{x:5,duration:.15}).to(e,{x:0,duration:.07,onComplete:()=>{r.to(e,{boxShadow:"0 4px 10px rgba(0, 0, 0, 0.15)",duration:.2,ease:"power2.out"})}})}),e.addEventListener("blur",()=>{r.to(e,{x:0,boxShadow:"none",duration:.3,ease:"power2.in"})})});const R=document.getElementById("inscription-nom"),H=document.getElementById("inscription-prenoms"),b=document.createElement("ul"),w=document.createElement("ul");b.className="suggestions-list",w.className="suggestions-list",R.parentNode.appendChild(b),H.parentNode.appendChild(w);let X={etudiants:[]};fetch("/etudiants.json").then(e=>{if(!e.ok)throw new Error("Erreur lors du chargement du fichier JSON");return e.json()}).then(e=>{X=e}).catch(e=>console.error("Erreur :",e)),document.addEventListener("click",e=>{e.target.closest(".suggestions-list")||e.target.matches("input")||[b,w].forEach(o=>{o.style.display==="block"&&r.to(o,{opacity:0,y:-10,duration:.2,onComplete:()=>o.style.display="none"})})});function B(e,t){return e?X.etudiants.filter(o=>o[t].toLowerCase().includes(e.toLowerCase())):[]}function Y(e,t,o){if(t.innerHTML="",o.length===0){t.style.display==="block"&&r.to(t,{opacity:0,y:-10,duration:.2,onComplete:()=>t.style.display="none"});return}o.forEach(n=>{const a=document.createElement("li");a.textContent=n,a.addEventListener("mouseenter",()=>{r.to(a,{backgroundColor:"var(--background-secondary)",duration:.2})}),a.addEventListener("mouseleave",()=>{r.to(a,{backgroundColor:"var(--background-primary)",duration:.2})}),a.addEventListener("click",()=>{e.value=n,r.to(t,{opacity:0,y:-10,duration:.2,onComplete:()=>t.style.display="none"})}),t.appendChild(a)}),t.style.display="block",t.style.opacity="0",r.fromTo(t,{opacity:0,y:-10},{opacity:1,y:0,duration:.3}),r.fromTo(t.children,{opacity:0,y:-10},{opacity:1,y:0,duration:.3,stagger:.05})}function $(e,t){const o=e.parentNode.querySelector(".erreur-message");o&&r.to(o,{opacity:0,y:10,duration:.2,onComplete:()=>o.remove()});const n=document.createElement("span");n.className="erreur-message",n.textContent=t,e.parentNode.appendChild(n),e.classList.add("input-error"),r.timeline().to(e,{x:-10,duration:.1}).to(e,{x:10,duration:.2}).to(e,{x:-5,duration:.15}).to(e,{x:5,duration:.15}).to(e,{x:0,duration:.07,onComplete:()=>{r.to(e,{boxShadow:"0 4px 10px rgba(0, 0, 0, 0.15)",duration:.2,ease:"power2.out"})}}),r.fromTo(n,{opacity:0,y:-10},{opacity:1,y:0,duration:.3}),setTimeout(()=>{r.to(n,{opacity:0,y:10,duration:.3,onComplete:()=>{n.remove(),e.classList.remove("input-error")}})},3e3)}[{input:R,suggestions:b,type:"nom"},{input:H,suggestions:w,type:"prenoms"}].forEach(({input:e,suggestions:t,type:o})=>{e.addEventListener("input",()=>{const n=e.value,a=B(n,o).map(c=>c[o]);Y(e,t,a)}),e.addEventListener("focus",()=>{const n=e.value,a=B(n,o).map(c=>c[o]);Y(e,t,a)}),e.addEventListener("blur",()=>{setTimeout(()=>{const n=e.value,a=B(n,o);n&&a.length===0?(e.setAttribute("invalid","true"),$(e,"Cette donnÃ©e est inexistante")):e.removeAttribute("invalid")},200)})});const _=document.getElementById("inscription-mdp"),p=document.getElementById("inscription-confirm-mdp");p.addEventListener("blur",()=>{setTimeout(()=>{const e=p.value;_.value!==e?(p.setAttribute("invalid","true"),$(p,"Les mots de passe ne correspondent pas")):p.removeAttribute("invalid")},200)}),document.querySelectorAll(".input-group").forEach(e=>{const t=e.querySelector('input[type="password"], input[type="text"]'),o=e.querySelector("lord-icon");if(t&&o){let n=!1;const a=y=>{r.to(o,{duration:.5,scale:1.1,blur:15,ease:"elastic.out(1, 0.5)",onComplete:()=>{r.to(o,{duration:.3,scale:1,blur:0,ease:"power2.out"})}})},c=y=>{r.to(t,{duration:.3,blur:10,opacity:0,ease:"power2.inOut",onComplete:()=>{t.type=y?"text":"password",o.setAttribute("state",y?"morph-lashes":"hover-lashes"),r.to(t,{duration:.3,blur:0,opacity:1,ease:"power2.out",clearProps:"y"})}})};o.addEventListener("click",()=>{a(),c(!n),n=!n})}});const l=document.querySelector(".upload-zone"),A=document.getElementById("photo-profil"),D=document.querySelector(".preview-container"),K=document.getElementById("preview-image"),ee=document.querySelector(".remove-preview"),P=document.querySelector(".error-message");function te(e){return["image/jpeg","image/png","image/gif"].includes(e.type)}function J(e){if(!te(e)){P.classList.add("active"),A.value="";return}P.classList.remove("active");const t=new FileReader;t.onload=function(o){K.src=o.target.result,D.classList.add("active"),r.from(D,{opacity:0,y:20,duration:.3,ease:"power2.out"})},t.readAsDataURL(e)}["dragenter","dragover","dragleave","drop"].forEach(e=>{l.addEventListener(e,oe,!1)});function oe(e){e.preventDefault(),e.stopPropagation()}["dragenter","dragover"].forEach(e=>{l.addEventListener(e,ne,!1)}),["dragleave","drop"].forEach(e=>{l.addEventListener(e,re,!1)});function ne(){l.classList.add("drag-over")}function re(){l.classList.remove("drag-over")}l.addEventListener("drop",ae,!1);function ae(e){const o=e.dataTransfer.files[0];J(o)}A.addEventListener("change",function(){this.files&&this.files[0]&&J(this.files[0])}),ee.addEventListener("click",function(){A.value="",D.classList.remove("active"),P.classList.remove("active")});const N=document.querySelector(".carousel-container"),Q=document.querySelectorAll(".carousel-slide"),j=document.querySelector(".dots-container");let m=0,M;Q.forEach((e,t)=>{const o=document.createElement("div");o.className="dot"+(t===0?" active":""),o.addEventListener("click",()=>ie(t)),j.appendChild(o)});function ie(e){m=e,U()}function U(){r.to(N,{duration:1,x:-m*100+"%",ease:"power2.inOut"}),document.querySelectorAll(".dot").forEach((e,t)=>{e.classList.toggle("active",t===m)})}function O(){M=setInterval(()=>{m=(m+1)%Q.length,U()},4e3)}O(),N.addEventListener("mouseenter",()=>clearInterval(M)),N.addEventListener("mouseleave",O),j.addEventListener("mouseenter",()=>clearInterval(M)),j.addEventListener("mouseleave",O)});
