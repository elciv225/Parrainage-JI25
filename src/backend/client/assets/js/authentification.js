import{g as r}from"../index.js";document.addEventListener("DOMContentLoaded",function(){const u=document.getElementById("inscription"),l=document.getElementById("connexion"),S=window.matchMedia("(max-width: 530px)").matches;function q(e,o=null){e&&e.preventDefault(),o=o||(e?e.target.getAttribute("href").substring(1):window.location.hash.substring(1));let t,n;o==="connexion"?(t=u,n=l,document.body.classList.remove("parrainage-active")):o==="inscription"&&(t=l,n=u,document.body.classList.remove("parrainage-active")),[u,l].forEach(O=>{r.set(O,{zIndex:-1,display:"none",opacity:0})});let i=150,s=0,x=-150,z=0;(o==="parrainage"||o==="ajout-photo")&&S&&(i=0,s=200),r.to(t,{opacity:0,x,y:z,scale:.95,duration:.3,ease:"power2.in",onComplete:()=>{t.style.display="none"}}),n.style.display="block",r.fromTo(n,{opacity:0,x:i,y:s,scale:.9},{opacity:1,x:0,y:0,scale:1,duration:.4,ease:"power2.out",onStart:()=>{n.style.zIndex=1},onComplete:()=>{n.style.zIndex=2}})}document.querySelectorAll('a[href="#connexion"], a[href="#inscription"]').forEach(e=>{e.addEventListener("click",q)});function C(e){const o=e.querySelector('button[type="submit"]');if(o){o.disabled=!0;const t=o.querySelector(".arrow-wrapper");t&&(t.style.display="none");let n=o.querySelector(".spinner");n||(n=document.createElement("div"),n.className="spinner",o.appendChild(n)),n.style.display="inline-block",n.style.opacity=1}}function E(e){const o=e.querySelector('button[type="submit"]');if(o){const t=o.querySelector(".spinner");t&&r.to(t,{opacity:0,scale:.8,duration:.3,ease:"power2.in",onComplete:()=>{t.style.display="none",o.disabled=!1;const n=o.querySelector(".arrow-wrapper");n&&(n.style.display="block")}})}}function p(e,o){C(e);const t=new FormData(e);fetch(o,{method:"POST",body:t}).then(n=>n.json()).then(n=>{E(e),n.success?(v(n.message,"success"),n.redirect&&setTimeout(()=>{window.location.href=n.redirect},1500)):v(n.message,"error")}).catch(n=>{console.error("Erreur:",n),E(e),v("Une erreur est survenue lors du traitement de votre demande.","error")})}const m=document.querySelector("#inscription form"),y=document.querySelector("#connexion form"),f=document.querySelector("#poserQ form");m&&m.addEventListener("submit",function(e){e.preventDefault(),p(m,"/inscription")}),y&&y.addEventListener("submit",function(e){e.preventDefault(),p(y,"/connexion")}),f&&f.addEventListener("submit",function(e){e.preventDefault(),p(f,"/poser/question")});function v(e,o="error"){const t=document.getElementById("popup-erreur"),n=document.getElementById("message-erreur"),i=document.getElementById("popup-title");o==="success"?(i.textContent="SuccÃ¨s",t.classList.remove("error"),t.classList.add("success")):(i.textContent="Attention",t.classList.remove("success"),t.classList.add("error")),n.textContent=e,t.classList.remove("hidden"),r.fromTo(t,{opacity:0,y:-20,scale:.8},{opacity:1,y:0,scale:1,duration:.5,ease:"power3.out"}),setTimeout(()=>{r.to(t,{opacity:0,y:-20,duration:.5,ease:"power2.in",onComplete:()=>{t.classList.add("hidden"),t.style.opacity=1,t.style.transform="translate(-50%, -50%)"}})},5e3)}const L=document.getElementById("fermer-popup"),c=document.getElementById("popup-erreur");L&&L.addEventListener("click",()=>{const e=document.getElementById("popup-erreur");r.to(e,{opacity:0,y:-20,duration:.5,ease:"power2.in",onComplete:()=>{e.classList.add("hidden"),e.style.opacity=1,e.style.transform="translate(-50%, -50%)"}})}),window.addEventListener("click",e=>{e.target===c&&r.to(c,{opacity:0,y:-20,duration:.3,ease:"power2.in",onComplete:()=>{c.classList.add("hidden"),c.style.opacity=1,c.style.transform="translateY(0)"}})}),r.set(l,{zIndex:-1,opacity:0,display:"none"}),r.set(u,{zIndex:1,opacity:1,display:"block"}),r.timeline().from(".principal-container",{opacity:0,scale:.9,y:50,duration:.5,ease:"power3.out"}).from(".section-droite",{opacity:0,x:40,duration:.5,ease:"power3.out"},"-=0.3").from("#inscription .header-form h3",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2").from("#inscription .body-form .input-group, #inscription .body-form .select-group",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2").from("#inscription .footer-form button",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2"),document.querySelectorAll(".input-group input, .select-group select").forEach(e=>{e.addEventListener("focus",()=>{r.timeline({defaults:{ease:"power2.inOut"}}).to(e,{x:-10,duration:.1}).to(e,{x:10,duration:.2}).to(e,{x:-5,duration:.15}).to(e,{x:5,duration:.15}).to(e,{x:0,duration:.07,onComplete:()=>{r.to(e,{boxShadow:"0 4px 10px rgba(0, 0, 0, 0.15)",duration:.2,ease:"power2.out"})}})}),e.addEventListener("blur",()=>{r.to(e,{x:0,boxShadow:"none",duration:.3,ease:"power2.in"})})});function T(e,o){const t=e.parentNode.querySelector(".erreur-message");t&&r.to(t,{opacity:0,y:10,duration:.2,onComplete:()=>t.remove()});const n=document.createElement("span");n.className="erreur-message",n.textContent=o,e.parentNode.insertBefore(n,e.nextSibling),e.classList.add("input-error"),r.timeline().to(e,{x:-10,duration:.1}).to(e,{x:10,duration:.1}).to(e,{x:-5,duration:.08}).to(e,{x:5,duration:.08}).to(e,{x:0,duration:.05}),r.fromTo(n,{opacity:0,y:-10},{opacity:1,y:0,duration:.3}),setTimeout(()=>{r.to(n,{opacity:0,y:10,duration:.3,onComplete:()=>{n.remove(),e.classList.remove("input-error")}})},3e3)}const B=document.getElementById("inscription-mdp"),d=document.getElementById("inscription-confirm-mdp");d.addEventListener("blur",()=>{setTimeout(()=>{const e=d.value;B.value!==e?(d.setAttribute("invalid","true"),T(d,"Les mots de passe ne correspondent pas")):d.removeAttribute("invalid")},200)}),document.querySelectorAll(".input-group").forEach(e=>{const o=e.querySelector('input[type="password"]'),t=e.querySelector(".toggle-password");if(o&&t){const n=t.querySelector(".eye-open"),i=t.querySelector(".eye-closed"),s=r.timeline({paused:!0});s.to(t,{duration:.4,rotation:180,ease:"back.out(1.7)",transformOrigin:"center center"}),s.to(i,{duration:.2,opacity:0,scale:.5,ease:"power2.out"},0),s.to(n,{duration:.3,opacity:1,scale:1,ease:"power2.out"},0);const x=()=>{r.to(o,{duration:.12,filter:"blur(5px)",ease:"power1.out",onComplete:()=>{o.type=o.type==="password"?"text":"password",o.type==="text"?s.play():s.reverse(),r.to(o,{duration:.3,filter:"blur(0px)",ease:"power1.out"})}})};t.addEventListener("click",function(){x()})}});const a=document.querySelector(".upload-zone"),g=document.getElementById("photo-profil"),w=document.querySelector(".preview-container"),D=document.getElementById("preview-image"),I=document.querySelector(".remove-preview"),h=document.querySelector(".error-message");function F(e){return["image/jpeg","image/png","image/gif"].includes(e.type)}function b(e){if(!F(e)){h.classList.add("active"),g.value="";return}h.classList.remove("active");const o=new FileReader;o.onload=function(t){D.src=t.target.result,w.classList.add("active"),r.from(w,{opacity:0,y:20,duration:.3,ease:"power2.out"})},o.readAsDataURL(e)}["dragenter","dragover","dragleave","drop"].forEach(e=>{a.addEventListener(e,k,!1)});function k(e){e.preventDefault(),e.stopPropagation()}["dragenter","dragover"].forEach(e=>{a.addEventListener(e,M,!1)}),["dragleave","drop"].forEach(e=>{a.addEventListener(e,A,!1)});function M(){a.classList.add("drag-over")}function A(){a.classList.remove("drag-over")}a.addEventListener("drop",P,!1);function P(e){const t=e.dataTransfer.files[0];b(t)}g.addEventListener("change",function(){this.files&&this.files[0]&&b(this.files[0])}),I.addEventListener("click",function(){g.value="",w.classList.remove("active"),h.classList.remove("active")})});
