import{g as r}from"../index.js";document.addEventListener("DOMContentLoaded",function(){const c=document.querySelectorAll(".question-item"),H=document.querySelectorAll(".option"),l=document.getElementById("next-btn"),m=document.getElementById("prev-btn"),A=document.getElementById("question-number"),R=document.querySelector(".progress-bar-inner"),y=document.getElementById("total-score");let a=0,f=0;const w=[];c.forEach((e,t)=>{t!==0&&r.set(e,{display:"none",opacity:0}),e.style.willChange="transform, opacity"});function b(){l.disabled=!0,m.disabled=a===0}function L(){const e=(a+1)/c.length*100;R.style.width=`${e}%`}H.forEach(e=>{e.addEventListener("click",function(){c[a].querySelectorAll(".option").forEach(n=>n.classList.remove("selected")),this.classList.add("selected");const o=parseInt(this.dataset.score,10)||0;w[a]={question:c[a].querySelector(".question").textContent.trim(),response:this.textContent.trim(),score:o},l.disabled=!1})});function P(e,t){r.to(e,{opacity:0,x:-40,duration:.25,ease:"power2.in",onComplete:()=>{e.style.display="none",t&&t()}})}function N(e,t){r.set(e,{display:"block",opacity:0,x:40}),r.to(e,{opacity:1,x:0,duration:.25,ease:"power2.out",onComplete:()=>{t&&t()}})}l.addEventListener("click",function(){const e=w[a];e&&(f+=e.score),y&&(y.value=f),l.disabled=!0,m.disabled=!0;const t=c[a];P(t,function(){if(a++,a<c.length){const o=c[a];A.innerText=a+1,L(),N(o,function(){b()})}else h(null,"ajout-photo")})}),m.addEventListener("click",function(){if(a>0){const e=w[a];e&&(f-=e.score),y&&(y.value=f),l.disabled=!0,m.disabled=!0;const t=c[a];P(t,function(){if(a--,a>=0){const o=c[a];A.innerText=a+1,L(),N(o,function(){b()})}})}}),L(),b(),r.from(".quiz-container",{opacity:0,scale:.95,duration:.5,ease:"power2.out"});const u=document.getElementById("inscription"),v=document.getElementById("connexion"),g=document.getElementById("parrainage"),S=document.getElementById("ajout-photo"),X=window.matchMedia("(max-width: 530px)").matches;function h(e,t=null){e&&e.preventDefault(),t=t||(e?e.target.getAttribute("href").substring(1):window.location.hash.substring(1));let o,n;t==="connexion"?(o=u,n=v,document.body.classList.remove("parrainage-active")):t==="inscription"?(o=v,n=u,document.body.classList.remove("parrainage-active")):t==="parrainage"?(o=u,n=g,document.body.classList.add("parrainage-active")):t==="ajout-photo"&&(o=g,n=S,document.body.classList.add("parrainage-active")),[u,v,g,S].forEach(_=>{r.set(_,{zIndex:-1,display:"none",opacity:0})});let i=150,s=0,D=-150,K=0;(t==="parrainage"||t==="ajout-photo")&&X&&(i=0,s=200),r.to(o,{opacity:0,x:D,y:K,scale:.95,duration:.3,ease:"power2.in",onComplete:()=>{o.style.display="none"}}),n.style.display="block",r.fromTo(n,{opacity:0,x:i,y:s,scale:.9},{opacity:1,x:0,y:0,scale:1,duration:.4,ease:"power2.out",onStart:()=>{n.style.zIndex=1},onComplete:()=>{n.style.zIndex=2}})}document.querySelectorAll('a[href="#connexion"], a[href="#inscription"]').forEach(e=>{e.addEventListener("click",h)});const q=document.querySelector("#inscription form"),I=document.querySelector("#ajout-photo form");q&&q.addEventListener("submit",function(e){e.preventDefault();const t=new FormData(q);t.forEach((n,i)=>{localStorage.setItem(i,n)});const o=t.get("niveau");o==="L1"||o==="L3"?h(null,"parrainage"):h(null,"ajout-photo")}),I&&(I.querySelectorAll("input, select").forEach(t=>{const o=localStorage.getItem(t.name);o&&(t.value=o)}),I.addEventListener("submit",function(){["nom","prenoms","niveau","email","motDePasse","confirmMotDePasse"].forEach(o=>{const n=localStorage.getItem(o);if(n){const i=document.querySelector(`#hidden-${o}`);i&&(i.value=n)}})})),r.set(v,{zIndex:-1,opacity:0,display:"none"}),r.set(g,{zIndex:-1,opacity:0,display:"none"}),r.set(S,{zIndex:-1,opacity:0,display:"none"}),r.set(u,{zIndex:1,opacity:1,display:"block"}),r.timeline().from(".principal-container",{opacity:0,scale:.9,y:50,duration:.5,ease:"power3.out"}).from(".section-droite",{opacity:0,x:40,duration:.5,ease:"power3.out"},"-=0.3").from("#inscription .header-form h3",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2").from("#inscription .body-form .input-group, #inscription .body-form .select-group",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2").from("#inscription .footer-form button",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2"),document.querySelectorAll(".input-group input, .select-group select").forEach(e=>{e.addEventListener("focus",()=>{r.timeline({defaults:{ease:"power2.inOut"}}).to(e,{x:-10,duration:.1}).to(e,{x:10,duration:.2}).to(e,{x:-5,duration:.15}).to(e,{x:5,duration:.15}).to(e,{x:0,duration:.07,onComplete:()=>{r.to(e,{boxShadow:"0 4px 10px rgba(0, 0, 0, 0.15)",duration:.2,ease:"power2.out"})}})}),e.addEventListener("blur",()=>{r.to(e,{x:0,boxShadow:"none",duration:.3,ease:"power2.in"})})});const j=document.getElementById("inscription-nom"),M=document.getElementById("inscription-prenoms"),E=document.createElement("ul"),x=document.createElement("ul");E.className="suggestions-list",x.className="suggestions-list",j.parentNode.appendChild(E),M.parentNode.appendChild(x);let O={etudiants:[]};fetch("/etudiants.json").then(e=>{if(!e.ok)throw new Error("Erreur lors du chargement du fichier JSON");return e.json()}).then(e=>{O=e}).catch(e=>console.error("Erreur :",e)),document.addEventListener("click",e=>{e.target.closest(".suggestions-list")||e.target.matches("input")||[E,x].forEach(o=>{o.style.display==="block"&&r.to(o,{opacity:0,y:-10,duration:.2,onComplete:()=>o.style.display="none"})})});function k(e,t){return e?O.etudiants.filter(o=>o[t].toLowerCase().includes(e.toLowerCase())):[]}function F(e,t,o){if(t.innerHTML="",o.length===0){t.style.display==="block"&&r.to(t,{opacity:0,y:-10,duration:.2,onComplete:()=>t.style.display="none"});return}o.forEach(n=>{const i=document.createElement("li");i.textContent=n,i.addEventListener("mouseenter",()=>{r.to(i,{backgroundColor:"var(--background-secondary)",duration:.2})}),i.addEventListener("mouseleave",()=>{r.to(i,{backgroundColor:"var(--background-primary)",duration:.2})}),i.addEventListener("click",()=>{e.value=n,r.to(t,{opacity:0,y:-10,duration:.2,onComplete:()=>t.style.display="none"})}),t.appendChild(i)}),t.style.display="block",t.style.opacity="0",r.fromTo(t,{opacity:0,y:-10},{opacity:1,y:0,duration:.3}),r.fromTo(t.children,{opacity:0,y:-10},{opacity:1,y:0,duration:.3,stagger:.05})}function z(e,t){const o=e.parentNode.querySelector(".erreur-message");o&&r.to(o,{opacity:0,y:10,duration:.2,onComplete:()=>o.remove()});const n=document.createElement("span");n.className="erreur-message",n.textContent=t,e.parentNode.appendChild(n),e.classList.add("input-error"),r.timeline().to(e,{x:-10,duration:.1}).to(e,{x:10,duration:.2}).to(e,{x:-5,duration:.15}).to(e,{x:5,duration:.15}).to(e,{x:0,duration:.07,onComplete:()=>{r.to(e,{boxShadow:"0 4px 10px rgba(0, 0, 0, 0.15)",duration:.2,ease:"power2.out"})}}),r.fromTo(n,{opacity:0,y:-10},{opacity:1,y:0,duration:.3}),setTimeout(()=>{r.to(n,{opacity:0,y:10,duration:.3,onComplete:()=>{n.remove(),e.classList.remove("input-error")}})},3e3)}[{input:j,suggestions:E,type:"nom"},{input:M,suggestions:x,type:"prenoms"}].forEach(({input:e,suggestions:t,type:o})=>{e.addEventListener("input",()=>{const n=e.value,i=k(n,o).map(s=>s[o]);F(e,t,i)}),e.addEventListener("focus",()=>{const n=e.value,i=k(n,o).map(s=>s[o]);F(e,t,i)}),e.addEventListener("blur",()=>{setTimeout(()=>{const n=e.value,i=k(n,o);n&&i.length===0?(e.setAttribute("invalid","true"),z(e,"Cette donnÃ©e est inexistante")):e.removeAttribute("invalid")},200)})});const Y=document.getElementById("inscription-mdp"),p=document.getElementById("inscription-confirm-mdp");p.addEventListener("blur",()=>{setTimeout(()=>{const e=p.value;Y.value!==e?(p.setAttribute("invalid","true"),z(p,"Les mots de passe ne correspondent pas")):p.removeAttribute("invalid")},200)}),document.querySelectorAll(".input-group").forEach(e=>{const t=e.querySelector('input[type="password"]'),o=e.querySelector(".toggle-password");if(t&&o){const n=o.querySelector(".eye-open"),i=o.querySelector(".eye-closed"),s=r.timeline({paused:!0});s.to(o,{duration:.4,rotation:180,ease:"back.out(1.7)",transformOrigin:"center center"}),s.to(i,{duration:.2,opacity:0,scale:.5,ease:"power2.out"},0),s.to(n,{duration:.3,opacity:1,scale:1,ease:"power2.out"},0);const D=()=>{r.to(t,{duration:.12,filter:"blur(5px)",ease:"power1.out",onComplete:()=>{t.type=t.type==="password"?"text":"password",t.type==="text"?s.play():s.reverse(),r.to(t,{duration:.3,filter:"blur(0px)",ease:"power1.out"})}})};o.addEventListener("click",function(){D()})}});const d=document.querySelector(".upload-zone"),C=document.getElementById("photo-profil"),T=document.querySelector(".preview-container"),$=document.getElementById("preview-image"),J=document.querySelector(".remove-preview"),B=document.querySelector(".error-message");function Q(e){return["image/jpeg","image/png","image/gif"].includes(e.type)}function G(e){if(!Q(e)){B.classList.add("active"),C.value="";return}B.classList.remove("active");const t=new FileReader;t.onload=function(o){$.src=o.target.result,T.classList.add("active"),r.from(T,{opacity:0,y:20,duration:.3,ease:"power2.out"})},t.readAsDataURL(e)}["dragenter","dragover","dragleave","drop"].forEach(e=>{d.addEventListener(e,U,!1)});function U(e){e.preventDefault(),e.stopPropagation()}["dragenter","dragover"].forEach(e=>{d.addEventListener(e,V,!1)}),["dragleave","drop"].forEach(e=>{d.addEventListener(e,W,!1)});function V(){d.classList.add("drag-over")}function W(){d.classList.remove("drag-over")}d.addEventListener("drop",Z,!1);function Z(e){const o=e.dataTransfer.files[0];G(o)}C.addEventListener("change",function(){this.files&&this.files[0]&&G(this.files[0])}),J.addEventListener("click",function(){C.value="",T.classList.remove("active"),B.classList.remove("active")})});
