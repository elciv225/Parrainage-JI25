import{g as r}from"../index.js";document.addEventListener("DOMContentLoaded",function(){const s=document.querySelectorAll(".question-item"),V=document.querySelectorAll(".option"),p=document.getElementById("next-btn"),h=document.getElementById("prev-btn"),z=document.getElementById("question-number"),W=document.querySelector(".progress-bar-inner"),g=document.getElementById("total-score");let i=0,l=0;const d=[];s.forEach((e,t)=>{t!==0&&r.set(e,{display:"none",opacity:0}),e.style.willChange="transform, opacity"});function q(){p.disabled=!0,h.disabled=i===0}function I(){const e=(i+1)/s.length*100;W.style.width=`${e}%`}V.forEach(e=>{e.addEventListener("click",function(){s[i].querySelectorAll(".option").forEach(n=>n.classList.remove("selected")),this.classList.add("selected");const o=parseInt(this.dataset.score,10)||0;d[i]={question:s[i].querySelector(".question").textContent.trim(),response:this.textContent.trim(),score:o},console.log(`Question: ${d[i].question}`),console.log(`Réponse: ${d[i].response}`),console.log(`Points: ${d[i].score}`),p.disabled=!1})});function $(e,t){r.to(e,{opacity:0,x:-40,duration:.25,ease:"power2.in",onComplete:()=>{e.style.display="none",t&&t()}})}function R(e,t){r.set(e,{display:"block",opacity:0,x:40}),r.to(e,{opacity:1,x:0,duration:.25,ease:"power2.out",onComplete:()=>{t&&t()}})}p.addEventListener("click",function(){const e=d[i];e&&(l+=e.score),g&&(g.value=l),p.disabled=!0,h.disabled=!0;const t=s[i];$(t,function(){if(i++,i<s.length){const o=s[i];z.innerText=i+1,I(),R(o,function(){q()})}else console.log(`Score total : ${l}`),b(null,"ajout-photo")})}),h.addEventListener("click",function(){if(i>0){const e=d[i];e&&(l-=e.score),g&&(g.value=l),console.log(`Score après retour : ${l}`),p.disabled=!0,h.disabled=!0;const t=s[i];$(t,function(){if(i--,i>=0){const o=s[i];z.innerText=i+1,I(),R(o,function(){q()})}})}}),I(),q(),r.from(".quiz-container",{opacity:0,scale:.95,duration:.5,ease:"power2.out"});const m=document.getElementById("inscription"),E=document.getElementById("connexion"),L=document.getElementById("parrainage"),C=document.getElementById("ajout-photo"),x=document.querySelector(".section-gauche");document.querySelector(".section-droite");const Z=window.matchMedia("(max-width: 530px)").matches;function b(e,t=null){e&&e.preventDefault(),t=t||(e?e.target.getAttribute("href").substring(1):null);let o,n;t==="connexion"?(o=m,n=E,document.body.classList.remove("parrainage-active"),x.style.display=""):t==="inscription"?(o=E,n=m,document.body.classList.remove("parrainage-active"),x.style.display=""):t==="parrainage"?(o=m,n=L,document.body.classList.add("parrainage-active"),x.style.display="none"):t==="ajout-photo"&&(o=L,n=C,document.body.classList.add("parrainage-active"),x.style.display="none"),[m,E,L,C].forEach(ce=>{r.set(ce,{zIndex:-1,display:"none",opacity:0})});let a=150,c=0,v=-150,se=0;(t==="parrainage"||t==="ajout-photo")&&Z&&(a=0,c=200),r.to(o,{opacity:0,x:v,y:se,scale:.95,duration:.3,ease:"power2.in",onComplete:()=>{o.style.display="none"}}),n.style.display="block",r.fromTo(n,{opacity:0,x:a,y:c,scale:.9},{opacity:1,x:0,y:0,scale:1,duration:.4,ease:"power2.out",onStart:()=>{n.style.zIndex=1},onComplete:()=>{n.style.zIndex=2}})}document.querySelectorAll('a[href="#connexion"], a[href="#inscription"]').forEach(e=>{e.addEventListener("click",b)});const T=document.querySelector("#inscription form"),k=document.querySelector("#ajout-photo form");T&&T.addEventListener("submit",function(e){e.preventDefault();const t=new FormData(T);t.forEach((n,a)=>{localStorage.setItem(a,n)});const o=t.get("niveau");o==="L1"||o==="L3"?b(null,"parrainage"):b(null,"ajout-photo")}),k&&(k.querySelectorAll("input, select").forEach(t=>{const o=localStorage.getItem(t.name);o&&(t.value=o)}),k.addEventListener("submit",function(){["nom","prenoms","niveau","email","motDePasse","confirmMotDePasse"].forEach(o=>{const n=localStorage.getItem(o);if(n){const a=document.querySelector(`#hidden-${o}`);a&&(a.value=n)}})})),r.set(E,{zIndex:-1,opacity:0,display:"none"}),r.set(L,{zIndex:-1,opacity:0,display:"none"}),r.set(C,{zIndex:-1,opacity:0,display:"none"}),r.set(m,{zIndex:1,opacity:1,display:"block"}),r.timeline().from(".principal-container",{opacity:0,scale:.9,y:50,duration:.5,ease:"power3.out"}).from(".section-gauche",{opacity:0,x:-40,duration:.5,ease:"power3.out"},"-=0.3").from(".section-droite",{opacity:0,x:40,duration:.5,ease:"power3.out"},"-=0.3").from("#inscription .header-form h3",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2").from("#inscription .body-form .input-group, #inscription .body-form .select-group",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2").from("#inscription .footer-form button",{opacity:0,y:20,duration:.4,ease:"power2.out",stagger:.1},"-=0.2"),document.querySelectorAll(".input-group input, .select-group select").forEach(e=>{e.addEventListener("focus",()=>{r.timeline({defaults:{ease:"power2.inOut"}}).to(e,{x:-10,duration:.1}).to(e,{x:10,duration:.2}).to(e,{x:-5,duration:.15}).to(e,{x:5,duration:.15}).to(e,{x:0,duration:.07,onComplete:()=>{r.to(e,{boxShadow:"0 4px 10px rgba(0, 0, 0, 0.15)",duration:.2,ease:"power2.out"})}})}),e.addEventListener("blur",()=>{r.to(e,{x:0,boxShadow:"none",duration:.3,ease:"power2.in"})})});const G=document.getElementById("inscription-nom"),H=document.getElementById("inscription-prenoms"),w=document.createElement("ul"),S=document.createElement("ul");w.className="suggestions-list",S.className="suggestions-list",G.parentNode.appendChild(w),H.parentNode.appendChild(S);let B={etudiants:[]};fetch("/etudiants.json").then(e=>{if(!e.ok)throw new Error("Erreur lors du chargement du fichier JSON");return e.json()}).then(e=>{B=e,console.log("Données chargées :",B)}).catch(e=>console.error("Erreur :",e)),document.addEventListener("click",e=>{e.target.closest(".suggestions-list")||e.target.matches("input")||[w,S].forEach(o=>{o.style.display==="block"&&r.to(o,{opacity:0,y:-10,duration:.2,onComplete:()=>o.style.display="none"})})});function D(e,t){return e?B.etudiants.filter(o=>o[t].toLowerCase().includes(e.toLowerCase())):[]}function Q(e,t,o){if(t.innerHTML="",o.length===0){t.style.display==="block"&&r.to(t,{opacity:0,y:-10,duration:.2,onComplete:()=>t.style.display="none"});return}o.forEach(n=>{const a=document.createElement("li");a.textContent=n,a.addEventListener("mouseenter",()=>{r.to(a,{backgroundColor:"var(--background-secondary)",duration:.2})}),a.addEventListener("mouseleave",()=>{r.to(a,{backgroundColor:"var(--background-primary)",duration:.2})}),a.addEventListener("click",()=>{e.value=n,r.to(t,{opacity:0,y:-10,duration:.2,onComplete:()=>t.style.display="none"})}),t.appendChild(a)}),t.style.display="block",t.style.opacity="0",r.fromTo(t,{opacity:0,y:-10},{opacity:1,y:0,duration:.3}),r.fromTo(t.children,{opacity:0,y:-10},{opacity:1,y:0,duration:.3,stagger:.05})}function X(e,t){const o=e.parentNode.querySelector(".erreur-message");o&&r.to(o,{opacity:0,y:10,duration:.2,onComplete:()=>o.remove()});const n=document.createElement("span");n.className="erreur-message",n.textContent=t,e.parentNode.appendChild(n),e.classList.add("input-error"),r.timeline().to(e,{x:-10,duration:.1}).to(e,{x:10,duration:.2}).to(e,{x:-5,duration:.15}).to(e,{x:5,duration:.15}).to(e,{x:0,duration:.07,onComplete:()=>{r.to(e,{boxShadow:"0 4px 10px rgba(0, 0, 0, 0.15)",duration:.2,ease:"power2.out"})}}),r.fromTo(n,{opacity:0,y:-10},{opacity:1,y:0,duration:.3}),setTimeout(()=>{r.to(n,{opacity:0,y:10,duration:.3,onComplete:()=>{n.remove(),e.classList.remove("input-error")}})},3e3)}[{input:G,suggestions:w,type:"nom"},{input:H,suggestions:S,type:"prenoms"}].forEach(({input:e,suggestions:t,type:o})=>{e.addEventListener("input",()=>{const n=e.value,a=D(n,o).map(c=>c[o]);Q(e,t,a)}),e.addEventListener("focus",()=>{const n=e.value,a=D(n,o).map(c=>c[o]);Q(e,t,a)}),e.addEventListener("blur",()=>{setTimeout(()=>{const n=e.value,a=D(n,o);n&&a.length===0?(e.setAttribute("invalid","true"),X(e,"Cette donnée est inexistante")):e.removeAttribute("invalid")},200)})});const _=document.getElementById("inscription-mdp"),y=document.getElementById("inscription-confirm-mdp");y.addEventListener("blur",()=>{setTimeout(()=>{const e=y.value;_.value!==e?(y.setAttribute("invalid","true"),X(y,"Les mots de passe ne correspondent pas")):y.removeAttribute("invalid")},200)}),document.querySelectorAll(".input-group").forEach(e=>{const t=e.querySelector('input[type="password"], input[type="text"]'),o=e.querySelector("lord-icon");if(t&&o){let n=!1;const a=v=>{r.to(o,{duration:.5,scale:1.1,blur:15,ease:"elastic.out(1, 0.5)",onComplete:()=>{r.to(o,{duration:.3,scale:1,blur:0,ease:"power2.out"})}})},c=v=>{r.to(t,{duration:.3,blur:10,opacity:0,ease:"power2.inOut",onComplete:()=>{t.type=v?"text":"password",o.setAttribute("state",v?"morph-lashes":"hover-lashes"),r.to(t,{duration:.3,blur:0,opacity:1,ease:"power2.out",clearProps:"y"})}})};o.addEventListener("click",()=>{a(),c(!n),n=!n})}});const u=document.querySelector(".upload-zone"),A=document.getElementById("photo-profil"),P=document.querySelector(".preview-container"),K=document.getElementById("preview-image"),ee=document.querySelector(".remove-preview"),N=document.querySelector(".error-message");function te(e){return["image/jpeg","image/png","image/gif"].includes(e.type)}function Y(e){if(!te(e)){N.classList.add("active"),A.value="";return}N.classList.remove("active");const t=new FileReader;t.onload=function(o){K.src=o.target.result,P.classList.add("active"),r.from(P,{opacity:0,y:20,duration:.3,ease:"power2.out"})},t.readAsDataURL(e)}["dragenter","dragover","dragleave","drop"].forEach(e=>{u.addEventListener(e,oe,!1)});function oe(e){e.preventDefault(),e.stopPropagation()}["dragenter","dragover"].forEach(e=>{u.addEventListener(e,ne,!1)}),["dragleave","drop"].forEach(e=>{u.addEventListener(e,re,!1)});function ne(){u.classList.add("drag-over")}function re(){u.classList.remove("drag-over")}u.addEventListener("drop",ae,!1);function ae(e){const o=e.dataTransfer.files[0];Y(o)}A.addEventListener("change",function(){this.files&&this.files[0]&&Y(this.files[0])}),ee.addEventListener("click",function(){A.value="",P.classList.remove("active"),N.classList.remove("active")});const j=document.querySelector(".carousel-container"),J=document.querySelectorAll(".carousel-slide"),M=document.querySelector(".dots-container");let f=0,O;J.forEach((e,t)=>{const o=document.createElement("div");o.className="dot"+(t===0?" active":""),o.addEventListener("click",()=>ie(t)),M.appendChild(o)});function ie(e){f=e,U()}function U(){r.to(j,{duration:1,x:-f*100+"%",ease:"power2.inOut"}),document.querySelectorAll(".dot").forEach((e,t)=>{e.classList.toggle("active",t===f)})}function F(){O=setInterval(()=>{f=(f+1)%J.length,U()},4e3)}F(),j.addEventListener("mouseenter",()=>clearInterval(O)),j.addEventListener("mouseleave",F),M.addEventListener("mouseenter",()=>clearInterval(O)),M.addEventListener("mouseleave",F)});
