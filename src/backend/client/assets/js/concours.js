import{g as p}from"../index.js";document.addEventListener("DOMContentLoaded",()=>{B.init();const a=document.querySelector(".header");let c=0;window.addEventListener("scroll",()=>{const e=window.pageYOffset;e>680?a.classList.add("scrolled"):a.classList.remove("scrolled"),e>c&&e>100?a.classList.add("hidden"):a.classList.remove("hidden"),c=e});const l=document.querySelectorAll(".carte-mpc");let s=null,r=document.querySelector(".overlay"),n=r.querySelector(".detail-container"),u,d;n?(u=n.querySelector(".close-btn"),d=n.querySelector(".detail-content"),u||(u=document.createElement("button"),u.className="close-btn",u.innerHTML="&times;",d?n.insertBefore(u,d):n.appendChild(u)),d||(d=document.createElement("div"),d.className="detail-content",n.appendChild(d))):(n=document.createElement("div"),n.className="detail-container",u=document.createElement("button"),u.className="close-btn",u.innerHTML="&times;",n.appendChild(u),d=document.createElement("div"),d.className="detail-content",n.appendChild(d),r.appendChild(n)),l.forEach(e=>{e.addEventListener("click",function(){A(e)})}),u&&u.addEventListener("click",S),r.addEventListener("click",function(e){e.target===r&&S()});function A(e){var t,f;if(!r||!d||!n)return;s=e;const i=e.querySelector(".overlay-details-content");if(d.innerHTML="",i)Array.from(i.children).forEach(g=>{d.appendChild(g.cloneNode(!0))});else{d.innerHTML="<p>Détails non disponibles.</p>";const g=((t=e.querySelector("h2"))==null?void 0:t.textContent)||"Titre",k=((f=e.querySelector("p"))==null?void 0:f.textContent)||"Description non fournie.";d.innerHTML=`<h2>${g}</h2><p>${k}</p>`}p.set(r,{display:"block"}),p.timeline().to(r,{duration:.3,autoAlpha:1}).to(n,{duration:.5,autoAlpha:1,y:0,scale:1,ease:"back.out(1.2)"},"-=0.1")}function S(){if(!r||!s||!n)return;p.timeline({onComplete:()=>{p.set(r,{display:"none"}),s=null}}).to(n,{duration:.3,autoAlpha:0,y:-20,scale:.95,ease:"power2.in"}).to(r,{duration:.2,autoAlpha:0},"-=0.1")}function C(e){const i=e.querySelector('button[type="submit"]');if(i){i.disabled=!0;const o=i.querySelector(".arrow-wrapper");o&&(o.style.display="none");let t=i.querySelector(".spinner");t||(t=document.createElement("div"),t.className="spinner",i.appendChild(t)),t.style.display="inline-block",t.style.opacity=1}}function q(e){const i=e.querySelector('button[type="submit"]');if(i){const o=i.querySelector(".spinner");o&&p.to(o,{opacity:0,scale:.8,duration:.3,ease:"power2.in",onComplete:()=>{o.style.display="none",i.disabled=!1;const t=i.querySelector(".arrow-wrapper");t&&(t.style.display="block")}})}}function y(e,i){C(e);const o=new FormData(e);fetch(i,{method:"POST",body:o}).then(t=>t.json()).then(t=>{q(e),t.success?(E(t.message,"success"),t.redirect&&setTimeout(()=>{window.location.href=t.redirect},1500)):E(t.message,"error")}).catch(t=>{console.error("Erreur:",t),q(e),E("Une erreur est survenue lors du traitement de votre demande.","error")})}const v=document.getElementById("#voteP1"),h=document.getElementById("#voteP2"),b=document.getElementById("#voteP3"),L=document.getElementById("#voteP4");v&&v.addEventListener("submit",function(e){e.preventDefault(),y(v,"/vote/projet")}),h&&h.addEventListener("submit",function(e){e.preventDefault(),y(h,"/vote/projet")}),b&&b.addEventListener("submit",function(e){e.preventDefault(),y(b,"/vote/projet")}),L&&L.addEventListener("submit",function(e){e.preventDefault(),y(L,"/vote/projet")});function E(e,i="error"){const o=document.getElementById("popup-erreur"),t=document.getElementById("message-erreur"),f=document.getElementById("popup-title");i==="success"?(f.textContent="Succès",o.classList.remove("error"),o.classList.add("success")):(f.textContent="Attention",o.classList.remove("success"),o.classList.add("error")),t.textContent=e,o.classList.remove("hidden"),p.fromTo(o,{opacity:0,y:-20,scale:.8},{opacity:1,y:0,scale:1,duration:.5,ease:"power3.out"}),setTimeout(()=>{p.to(o,{opacity:0,y:-20,duration:.5,ease:"power2.in",onComplete:()=>{o.classList.add("hidden"),o.style.opacity=1,o.style.transform="translate(-50%, -50%)"}})},5e3)}const w=document.getElementById("fermer-popup"),m=document.getElementById("popup-erreur");w&&w.addEventListener("click",()=>{const e=document.getElementById("popup-erreur");p.to(e,{opacity:0,y:-20,duration:.5,ease:"power2.in",onComplete:()=>{e.classList.add("hidden"),e.style.opacity=1,e.style.transform="translate(-50%, -50%)"}})}),window.addEventListener("click",e=>{e.target===m&&p.to(m,{opacity:0,y:-20,duration:.3,ease:"power2.in",onComplete:()=>{m.classList.add("hidden"),m.style.opacity=1,m.style.transform="translateY(0)"}})})});const B={init(){this.initSmoothScroll(),this.initAnimationsScroll(),this.initBurgerMenu(),this.initFAQ()},initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(c=>{c.addEventListener("click",function(l){l.preventDefault();const s=document.querySelector(this.getAttribute("href"));s&&s.scrollIntoView({behavior:"smooth",block:"start"})})})},initAnimationsScroll(){const a={threshold:.1},c=new IntersectionObserver((s,r)=>{s.forEach(n=>{n.isIntersecting&&(n.target.classList.add("animate"),r.unobserve(n.target))})},a);document.querySelectorAll(".carte-activite, .membre-equipe, .faq-item").forEach(s=>c.observe(s))},initBurgerMenu(){const a=document.querySelector(".hamburger"),c=a?a.querySelector("i"):null,l=document.querySelector(".menu-mobile");a&&l&&c&&(a.addEventListener("click",s=>{s.stopPropagation(),l.classList.toggle("open");const r=l.classList.contains("open");c.className=r?"fa-solid fa-xmark":"fa-solid fa-bars"}),l.addEventListener("click",s=>{s.stopPropagation()}),document.addEventListener("click",()=>{l.classList.contains("open")&&(l.classList.remove("open"),c.className="fa-solid fa-bars")}))},initFAQ(){const a=document.querySelectorAll(".faq-item");a.forEach(c=>{const l=c.querySelector(".faq-question");l&&l.addEventListener("click",s=>{s.stopPropagation(),a.forEach(r=>{if(r!==c){r.classList.remove("active");const n=r.querySelector(".faq-question");n&&n.setAttribute("aria-expanded","false")}}),c.classList.toggle("active"),l.setAttribute("aria-expanded",c.classList.contains("active")?"true":"false")}),c.addEventListener("click",s=>s.stopPropagation())})}};
