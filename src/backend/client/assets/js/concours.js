import{g as p}from"../index.js";document.addEventListener("DOMContentLoaded",()=>{w.init();const c=document.querySelector(".header");let a=0;window.addEventListener("scroll",()=>{const e=window.pageYOffset;e>680?c.classList.add("scrolled"):c.classList.remove("scrolled"),e>a&&e>100?c.classList.add("hidden"):c.classList.remove("hidden"),a=e});const l=document.querySelectorAll(".carte-mpc");let r=null,i=document.querySelector(".overlay"),n=i.querySelector(".detail-container"),u,d;n?(u=n.querySelector(".close-btn"),d=n.querySelector(".detail-content"),u||(u=document.createElement("button"),u.className="close-btn",u.innerHTML="&times;",d?n.insertBefore(u,d):n.appendChild(u)),d||(d=document.createElement("div"),d.className="detail-content",n.appendChild(d))):(n=document.createElement("div"),n.className="detail-container",u=document.createElement("button"),u.className="close-btn",u.innerHTML="&times;",n.appendChild(u),d=document.createElement("div"),d.className="detail-content",n.appendChild(d),i.appendChild(n)),l.forEach(e=>{e.addEventListener("click",function(){S(e)})}),u&&u.addEventListener("click",v),i.addEventListener("click",function(e){e.target===i&&v()});function S(e){var t,f;if(!i||!d||!n)return;r=e;const s=e.querySelector(".overlay-details-content");if(d.innerHTML="",s)Array.from(s.children).forEach(h=>{d.appendChild(h.cloneNode(!0))});else{d.innerHTML="<p>Détails non disponibles.</p>";const h=((t=e.querySelector("h2"))==null?void 0:t.textContent)||"Titre",q=((f=e.querySelector("p"))==null?void 0:f.textContent)||"Description non fournie.";d.innerHTML=`<h2>${h}</h2><p>${q}</p>`}p.set(i,{display:"block"}),p.timeline().to(i,{duration:.3,autoAlpha:1}).to(n,{duration:.5,autoAlpha:1,y:0,scale:1,ease:"back.out(1.2)"},"-=0.1")}function v(){if(!i||!r||!n)return;p.timeline({onComplete:()=>{p.set(i,{display:"none"}),r=null}}).to(n,{duration:.3,autoAlpha:0,y:-20,scale:.95,ease:"power2.in"}).to(i,{duration:.2,autoAlpha:0},"-=0.1")}function E(e){const s=e.querySelector('button[type="submit"]');if(s){s.disabled=!0;const o=s.querySelector(".arrow-wrapper");o&&(o.style.display="none");let t=s.querySelector(".spinner");t||(t=document.createElement("div"),t.className="spinner",s.appendChild(t)),t.style.display="inline-block",t.style.opacity=1}}function b(e){const s=e.querySelector('button[type="submit"]');if(s){const o=s.querySelector(".spinner");o&&p.to(o,{opacity:0,scale:.8,duration:.3,ease:"power2.in",onComplete:()=>{o.style.display="none",s.disabled=!1;const t=s.querySelector(".arrow-wrapper");t&&(t.style.display="block")}})}}function g(e,s){E(e);const o=new FormData(e);fetch(s,{method:"POST",body:o}).then(t=>t.json()).then(t=>{b(e),t.success?(y(t.message,"success"),t.redirect&&setTimeout(()=>{window.location.href=t.redirect},1500)):y(t.message,"error")}).catch(t=>{console.error("Erreur:",t),b(e),y("Une erreur est survenue lors du traitement de votre demande.","error")})}document.querySelectorAll(".form-vote").forEach(e=>{e.addEventListener("submit",function(s){s.preventDefault(),g(e,"/vote/projet")})});function y(e,s="error"){const o=document.getElementById("popup-erreur"),t=document.getElementById("message-erreur"),f=document.getElementById("popup-title");s==="success"?(f.textContent="Succès",o.classList.remove("error"),o.classList.add("success")):(f.textContent="Attention",o.classList.remove("success"),o.classList.add("error")),t.textContent=e,o.classList.remove("hidden"),p.fromTo(o,{opacity:0,y:-20,scale:.8},{opacity:1,y:0,scale:1,duration:.5,ease:"power3.out"}),setTimeout(()=>{p.to(o,{opacity:0,y:-20,duration:.5,ease:"power2.in",onComplete:()=>{o.classList.add("hidden"),o.style.opacity=1,o.style.transform="translate(-50%, -50%)"}})},5e3)}const L=document.getElementById("fermer-popup"),m=document.getElementById("popup-erreur");L&&L.addEventListener("click",()=>{const e=document.getElementById("popup-erreur");p.to(e,{opacity:0,y:-20,duration:.5,ease:"power2.in",onComplete:()=>{e.classList.add("hidden"),e.style.opacity=1,e.style.transform="translate(-50%, -50%)"}})}),window.addEventListener("click",e=>{e.target===m&&p.to(m,{opacity:0,y:-20,duration:.3,ease:"power2.in",onComplete:()=>{m.classList.add("hidden"),m.style.opacity=1,m.style.transform="translateY(0)"}})})});const w={init(){this.initSmoothScroll(),this.initAnimationsScroll(),this.initBurgerMenu(),this.initFAQ()},initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(l){l.preventDefault();const r=document.querySelector(this.getAttribute("href"));r&&r.scrollIntoView({behavior:"smooth",block:"start"})})})},initAnimationsScroll(){const c={threshold:.1},a=new IntersectionObserver((r,i)=>{r.forEach(n=>{n.isIntersecting&&(n.target.classList.add("animate"),i.unobserve(n.target))})},c);document.querySelectorAll(".carte-activite, .membre-equipe, .faq-item").forEach(r=>a.observe(r))},initBurgerMenu(){const c=document.querySelector(".hamburger"),a=c?c.querySelector("i"):null,l=document.querySelector(".menu-mobile");c&&l&&a&&(c.addEventListener("click",r=>{r.stopPropagation(),l.classList.toggle("open");const i=l.classList.contains("open");a.className=i?"fa-solid fa-xmark":"fa-solid fa-bars"}),l.addEventListener("click",r=>{r.stopPropagation()}),document.addEventListener("click",()=>{l.classList.contains("open")&&(l.classList.remove("open"),a.className="fa-solid fa-bars")}))},initFAQ(){const c=document.querySelectorAll(".faq-item");c.forEach(a=>{const l=a.querySelector(".faq-question");l&&l.addEventListener("click",r=>{r.stopPropagation(),c.forEach(i=>{if(i!==a){i.classList.remove("active");const n=i.querySelector(".faq-question");n&&n.setAttribute("aria-expanded","false")}}),a.classList.toggle("active"),l.setAttribute("aria-expanded",a.classList.contains("active")?"true":"false")}),a.addEventListener("click",r=>r.stopPropagation())})}};
